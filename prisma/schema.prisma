generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Cargo {
  PROPRIETARIA
  RH
  DESIGNER
  REDATORA
  VIDEOMAKER
  GESTORTRAFEGO
}

model Empresa {
  cod       Int     @id @default(autoincrement())
  funcionario_id Int
  cnpj      String  @unique @db.VarChar(18)
  nome      String  @db.VarChar(100)
  email     String  @unique @db.VarChar(100)
  senha     String  @db.VarChar(100)
  setor     String  @db.VarChar(100)
  logotipo  String  @db.VarChar(255)
  ativa     Boolean @default(true)
  createdAt    DateTime     @default(now())
  deletedAt    DateTime?
  updatedAt    DateTime     @updatedAt
  funcionario   Funcionario @relation(fields: [funcionario_id], references: [id])
  feedbacks Feedback[]
  contratos Contrato[]
}

model Feedback {
  id          Int         @id @default(autoincrement())
  empresaCod  Int     
  titulo      String      @db.VarChar(100)
  avaliacao   Int
  comentario  String      @db.VarChar(255)
  data        DateTime    @db.Date
  empresa     Empresa     @relation(fields: [empresaCod], references: [cod])
}

model Funcionario {
  id         Int      @id @default(autoincrement())
  nome       String   @db.VarChar(100)
  email      String   @unique @db.VarChar(100)
  senha      String   @db.VarChar(100)
  telefone   String   @unique @db.VarChar(15)
  sobre      String   @db.VarChar(255)
  dtnasc     DateTime @db.Date
  foto       String   @db.VarChar(255)
  cargo      Cargo
  createdAt    DateTime     @default(now())
  deletedAt    DateTime?
  updatedAt    DateTime     @updatedAt
  atividades Atividade[]
  comentarios Comentario[]
  empresas   Empresa[]
  servicos   Servico[]
}

model Servico {
  cod         Int     @id @default(autoincrement())
  funcionario_id     Int
  nome        String  @unique @db.VarChar(100)
  descricao   String  @db.VarChar(255)
  preco       Float
  simbolo     String  @db.VarChar(255)
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  funcionario   Funcionario @relation(fields: [funcionario_id], references: [id])
  contratos   Contrato[]
}

model Contrato {
  id            Int       @id @default(autoincrement())
  empresaCod    Int  
  servicoId     Int
  termos        String    @db.VarChar(255)
  dataInicio    DateTime  @db.Date 
  dataFim       DateTime  @db.Date
  valorTotal    Float
  empresa       Empresa   @relation(fields: [empresaCod], references: [cod])
  servico       Servico   @relation(fields: [servicoId], references: [cod])
}

model Atividade {
  id             Int       @id @default(autoincrement())
  funcionarioId  Int
  tarefa         String    @db.VarChar(100)
  area           String    @db.VarChar(100)
  descricao      String    @db.VarChar(255)
  // prioridade: baixa, media, alta
  prioridade     String    @db.VarChar(60)
  // status: pendente, em andamento, concluida
  status         String    @db.VarChar(60)
  ultimaModificacao DateTime
  arquivos     Arquivo[]
  comentarios  Comentario[]
  funcionario       Funcionario @relation(fields: [funcionarioId], references: [id])
}

model Arquivo {
  id          Int       @id @default(autoincrement())
  atividadeId Int
  nome        String    @db.VarChar(100)
  url         String    @db.VarChar(255)
  // tipo: pdf, docx, png, jpg, etc
  tipo        String    @db.VarChar(50)
  uploadData  DateTime
  atividade   Atividade @relation(fields: [atividadeId], references: [id])
}

model Comentario {
  id          Int         @id @default(autoincrement())
  atividadeId Int
  funcionarioId Int
  descricao    String     @db.VarChar(255)
  data        DateTime
  atividade   Atividade   @relation(fields: [atividadeId], references: [id])
  funcionario Funcionario @relation(fields: [funcionarioId], references: [id])
}

model Projeto {
  id          Int       @id @default(autoincrement())
  nome        String    @unique @db.VarChar(100)
  descricao   String    @db.VarChar(255)
  // categoria: marketing, desenvolvimento, design, etc
  categoria    String   @db.VarChar(100)
  // status: planejado, em andamento, concluido
  status      String    @db.VarChar(60)
  prazo       DateTime  @db.Date
  dataInicio  DateTime  @db.Date
  dataFim     DateTime  @db.Date
}
